extends layout

block content
    .span9(ng-controller="LobbyController")
        .content
            .content-breadcrumb
                ul.breadcrumb-nav.pull-right
                    li.btn-group(ng-repeat="room in rooms")
                        a.btn.btn-small.btn-link(href="javascript:;", ng-click="changeRoom(room.roomName)", ng-class="(room.roomName == currentRoom.roomName && 'active')")
                            i.icofont-tasks
                            | &nbsp;{{ room.roomName }}
                ul.breadcrumb
                    li
                        a(href="/")
                            i.icofont-home
                            | &nbsp; Home
                        span.divider &rsaquo;
                    li
                        a(href="/lobby") Lobby
                        span.divider &rsaquo;
                    li.active
                        | Current room: {{ currentRoom.roomName }} - {{ currentRoom.numPlayers }} player
            .content-body
                .row-fluid
                    .span4(ng-repeat="tbl in tables", ng-style="clearLeftMargin($index, 3)")
                        .box.corner-all(ng-controller="TableController", ng-init="init(tbl)")
                            .box-header.grd-white
                                span {{ table.tableName }}&nbsp; - &nbsp;
                                span.muted(style="font-size: 11px;") {{ table.status }}
                            .box-body
                                .row(style="margin-left: 0px;")
                                    p.clearLeftMargin
                                        .span6(ng-repeat="seat in table.seats", ng-style="clearLeftMargin($index, 2)")
                                            .seat-item
                                                span {{ (!seat.username) ? 'Empty' : seat.username }}
                                                .btn-group.pull-right(ng-show="showSeatButton(seat) && showSeatWithOptions(seat)")
                                                    button.btn.btn-mini.btn-info.pull-right.dropdown-toggle(data-toggle="dropdown")
                                                        | Take Seat
                                                        | &nbsp;
                                                        span.caret
                                                    ul.dropdown-menu(style="min-width: 0px;")
                                                        li
                                                            a(href="javascript:;", ng-click="takeSeat(seat, false)") Sit as player
                                                        li(ng-show="showSitAsLeader()")
                                                            a(href="javascript:;", ng-click="takeSeat(seat, true)") Sit as leader
                                                .btn-group.pull-right(ng-show="showSeatButton(seat) && !showSeatWithOptions(seat)")
                                                    button.btn.btn-mini.btn-info.pull-right(ng-click="leaveSeat(seat)") Leave Seat
                        div(ng-class="($index + 1 % 3 == 0 && 'clear')")

    .span2(ng-controller="ChatController")
        aside.side-right
            .sidebar-right
                .sidebar-right-content
                    .side-chat
                        .chat-header
                            h5
                                i.icofont-certificate.color-green
                                | &nbsp; {{ currentUser.username }}&nbsp; - &nbsp;
                                span.muted {{ currentRoom }}
                        .chat-content
                            .chat-in(ng-repeat="msg in chatLog")
                                span.chat-time(ng-show="!msg.serverGenerated") {{ msg.timestamp | chatTime }}
                                strong.chat-user(ng-show="!msg.serverGenerated") {{ msg.user }}:
                                .chat-text {{ msg.body }}
                        .chat-input
                            .chat-desc.muted Enter your message:
                            textarea.input-block-level(placeholder="Message", ng-model="chatMsg")
                            button.btn.btn-small.btn-block(ng-click="sendMsg()") Submit
                    .divider-content
                        span